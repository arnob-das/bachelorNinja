

CREATE DATABASE MessManagement;

USE MessManagement;


CREATE TABLE Users (
    Id INT PRIMARY KEY IDENTITY(1,1),
    FullName NVARCHAR(100) NOT NULL,
    PhoneNo NVARCHAR(15) NOT NULL,
    NidNo NVARCHAR(20) NOT NULL,
    Email NVARCHAR(255) NOT NULL,
    Password NVARCHAR(100) NOT NULL
);


CREATE TABLE Messes (
    Id INT PRIMARY KEY IDENTITY(1,1),
    MessName NVARCHAR(255),
    MessLocation NVARCHAR(255),
    MessOwnerName NVARCHAR(100),
    MessOwnerPhoneNo NVARCHAR(15)
);


CREATE TABLE Managers (
    Id INT PRIMARY KEY IDENTITY(1,1),
    FullName NVARCHAR(100) NOT NULL,
    PhoneNo NVARCHAR(15) NOT NULL,
    NidNo NVARCHAR(20) NOT NULL,
    Email NVARCHAR(255) NOT NULL,
    Password NVARCHAR(100) NOT NULL
);


CREATE TABLE GroceryCosts (
    Id INT PRIMARY KEY IDENTITY(1,1),
    UserId INT NOT NULL FOREIGN KEY REFERENCES Users(Id),
    MessId INT NOT NULL FOREIGN KEY REFERENCES Messes(Id),
    Day INT NOT NULL CHECK(Day BETWEEN 1 AND 31),
    Month INT NOT NULL CHECK(Month BETWEEN 1 AND 12),
    Year INT NOT NULL,
    Amount INT NOT NULL
);


CREATE TABLE MealInformations (
    Id INT PRIMARY KEY IDENTITY(1,1),
    UserId INT NOT NULL FOREIGN KEY REFERENCES Users(Id),
    MessId INT NOT NULL FOREIGN KEY REFERENCES Messes(Id),
    Day INT NOT NULL CHECK(Day BETWEEN 1 AND 31),
    Month INT NOT NULL CHECK(Month BETWEEN 1 AND 12),
    Year INT NOT NULL,
    MealCount INT NOT NULL
);


CREATE TABLE MessManagers (
    Id INT PRIMARY KEY IDENTITY(1,1),
    MessId INT NOT NULL FOREIGN KEY REFERENCES Messes(Id),
    ManagerId INT NOT NULL FOREIGN KEY REFERENCES Managers(Id)
);


CREATE TABLE MessMembers (
    Id INT PRIMARY KEY IDENTITY(1,1),
    UserId INT NOT NULL FOREIGN KEY REFERENCES Users(Id),
    MessId INT NOT NULL FOREIGN KEY REFERENCES Messes(Id)
);


CREATE TABLE RoomRents (
    Id INT PRIMARY KEY IDENTITY(1,1),
    MessId INT NOT NULL FOREIGN KEY REFERENCES Messes(Id),
    UserId INT NOT NULL FOREIGN KEY REFERENCES Users(Id),
    Rent DECIMAL(18,2) NOT NULL
);


CREATE TABLE UtilityBills (
    Id INT PRIMARY KEY IDENTITY(1,1),
    MessId INT NOT NULL FOREIGN KEY REFERENCES Messes(Id),
    UtilityName NVARCHAR(255) NOT NULL,
    UtilityCost DECIMAL(18,2) NOT NULL,
    Month INT NOT NULL CHECK(Month BETWEEN 1 AND 12),
    Year INT NOT NULL CHECK(Year BETWEEN 2000 AND 2100)
);
